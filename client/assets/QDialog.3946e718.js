import{c as Qe,d as je,g as Xe,f as Ye}from"./use-key-composition.939e4fb3.js";import{n as me,aD as ge,z as b,P as k,x as Te,aE as Ie,l as ve,ak as Ue,r as z,c as m,w as J,H as Ge,h as p,m as Ee,p as de,g as Ce,aF as Pe}from"./index.aa73692f.js";import{h as Je,f as Ne,j as Ze,k as et,u as Be,l as Fe,v as he,m as tt,a as Le,o as He,d as Oe,p as _e,q as ot,r as nt,b as De,s as Me,t as ye,g as it,w as lt,x as we,y as st,z as at}from"./position-engine.3fcad627.js";import{u as rt,a as ut,b as ze}from"./focus-manager.6aaf34c3.js";function ct(e,t,a){let i;function s(){i!==void 0&&(ge.remove(i),i=void 0)}return me(()=>{e.value===!0&&s()}),{removeFromHistory:s,addToHistory(){i={condition:()=>a.value===!0,handler:t},ge.add(i)}}}let D=0,re,ue,M,ce=!1,be,xe,qe,S=null;function dt(e){ft(e)&&Te(e)}function ft(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=Ie(e),a=e.shiftKey&&!e.deltaX,i=!a&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),s=a||i?e.deltaY:e.deltaX;for(let u=0;u<t.length;u++){const l=t[u];if(Ze(l,i))return i?s<0&&l.scrollTop===0?!0:s>0&&l.scrollTop+l.clientHeight===l.scrollHeight:s<0&&l.scrollLeft===0?!0:s>0&&l.scrollLeft+l.clientWidth===l.scrollWidth}return!0}function ke(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function U(e){ce!==!0&&(ce=!0,requestAnimationFrame(()=>{ce=!1;const{height:t}=e.target,{clientHeight:a,scrollTop:i}=document.scrollingElement;(M===void 0||t!==window.innerHeight)&&(M=a-t,document.scrollingElement.scrollTop=i),i>M&&(document.scrollingElement.scrollTop-=Math.ceil((i-M)/8))}))}function Se(e){const t=document.body,a=window.visualViewport!==void 0;if(e==="add"){const{overflowY:i,overflowX:s}=window.getComputedStyle(t);re=Je(window),ue=Ne(window),be=t.style.left,xe=t.style.top,qe=window.location.href,t.style.left=`-${re}px`,t.style.top=`-${ue}px`,s!=="hidden"&&(s==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),i!=="hidden"&&(i==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,b.is.ios===!0&&(a===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",U,k.passiveCapture),window.visualViewport.addEventListener("scroll",U,k.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",ke,k.passiveCapture))}b.is.desktop===!0&&b.is.mac===!0&&window[`${e}EventListener`]("wheel",dt,k.notPassive),e==="remove"&&(b.is.ios===!0&&(a===!0?(window.visualViewport.removeEventListener("resize",U,k.passiveCapture),window.visualViewport.removeEventListener("scroll",U,k.passiveCapture)):window.removeEventListener("scroll",ke,k.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=be,t.style.top=xe,window.location.href===qe&&window.scrollTo(re,ue),M=void 0)}function mt(e){let t="add";if(e===!0){if(D++,S!==null){clearTimeout(S),S=null;return}if(D>1)return}else{if(D===0||(D--,D>0))return;if(t="remove",b.is.ios===!0&&b.is.nativeMobile===!0){S!==null&&clearTimeout(S),S=setTimeout(()=>{Se(t),S=null},100);return}}Se(t)}function vt(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,mt(t))}}}var St=ve({name:"QField",inheritAttrs:!1,props:{...Qe,tag:{type:String,default:"label"}},emits:je,setup(){return Xe(Ye({requiredForAttr:!1,tagProp:!0}))}});const T=[];let F;function gt(e){F=e.keyCode===27}function ht(){F===!0&&(F=!1)}function yt(e){F===!0&&(F=!1,Ue(e,27)===!0&&T[T.length-1](e))}function Ae(e){window[e]("keydown",gt),window[e]("blur",ht),window[e]("keyup",yt),F=!1}function Re(e){b.is.desktop===!0&&(T.push(e),T.length===1&&Ae("addEventListener"))}function N(e){const t=T.indexOf(e);t>-1&&(T.splice(t,1),T.length===0&&Ae("removeEventListener"))}const E=[];function Ke(e){E[E.length-1](e)}function Ve(e){b.is.desktop===!0&&(E.push(e),E.length===1&&document.body.addEventListener("focusin",Ke))}function fe(e){const t=E.indexOf(e);t>-1&&(E.splice(t,1),E.length===0&&document.body.removeEventListener("focusin",Ke))}var pt=ve({name:"QMenu",inheritAttrs:!1,props:{...et,...Be,...rt,...Fe,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:he},self:{type:String,validator:he},offset:{type:Array,validator:tt},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Le,"click","escapeKey"],setup(e,{slots:t,emit:a,attrs:i}){let s=null,u,l,h;const v=Ce(),{proxy:d}=v,{$q:c}=d,f=z(null),y=z(!1),A=m(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),R=ut(e,c),{registerTick:Z,removeTick:K}=He(),{registerTimeout:V}=Oe(),{transitionProps:W,transitionStyle:$}=_e(e),{localScrollTarget:L,changeScrollEvent:ee,unconfigureScrollTarget:te}=ot(e,B),{anchorEl:g,canShow:oe}=nt({showing:y}),{hide:Q}=De({showing:y,canShow:oe,handleShow:_,handleHide:le,hideOnRouteChange:A,processOnMount:!0}),{showPortal:j,hidePortal:x,renderPortal:ne}=Me(v,f,I,"menu"),H={anchorEl:g,innerRef:f,onClickOutside(o){if(e.persistent!==!0&&y.value===!0)return Q(o),(o.type==="touchstart"||o.target.classList.contains("q-dialog__backdrop"))&&Te(o),!0}},X=m(()=>we(e.anchor||(e.cover===!0?"center middle":"bottom start"),c.lang.rtl)),ie=m(()=>e.cover===!0?X.value:we(e.self||"top start",c.lang.rtl)),q=m(()=>(e.square===!0?" q-menu--square":"")+(R.value===!0?" q-menu--dark q-dark":"")),O=m(()=>e.autoClose===!0?{onClick:se}:{}),C=m(()=>y.value===!0&&e.persistent!==!0);J(C,o=>{o===!0?(Re(r),at(H)):(N(r),ye(H))});function P(){ze(()=>{let o=f.value;o&&o.contains(document.activeElement)!==!0&&(o=o.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||o.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||o.querySelector("[autofocus], [data-autofocus]")||o,o.focus({preventScroll:!0}))})}function _(o){if(s=e.noRefocus===!1?document.activeElement:null,Ve(n),j(),B(),u=void 0,o!==void 0&&(e.touchPosition||e.contextMenu)){const ae=Ge(o);if(ae.left!==void 0){const{top:We,left:$e}=g.value.getBoundingClientRect();u={left:ae.left-$e,top:ae.top-We}}}l===void 0&&(l=J(()=>c.screen.width+"|"+c.screen.height+"|"+e.self+"|"+e.anchor+"|"+c.lang.rtl,w)),e.noFocus!==!0&&document.activeElement.blur(),Z(()=>{w(),e.noFocus!==!0&&P()}),V(()=>{c.platform.is.ios===!0&&(h=e.autoClose,f.value.click()),w(),j(!0),a("show",o)},e.transitionDuration)}function le(o){K(),x(),Y(!0),s!==null&&(o===void 0||o.qClickOutside!==!0)&&(((o&&o.type.indexOf("key")===0?s.closest('[tabindex]:not([tabindex^="-"])'):void 0)||s).focus(),s=null),V(()=>{x(!0),a("hide",o)},e.transitionDuration)}function Y(o){u=void 0,l!==void 0&&(l(),l=void 0),(o===!0||y.value===!0)&&(fe(n),te(),ye(H),N(r)),o!==!0&&(s=null)}function B(){(g.value!==null||e.scrollTarget!==void 0)&&(L.value=it(g.value,e.scrollTarget),ee(L.value,w))}function se(o){h!==!0?(st(d,o),a("click",o)):h=!1}function n(o){C.value===!0&&e.noFocus!==!0&&Pe(f.value,o.target)!==!0&&P()}function r(o){a("escapeKey"),Q(o)}function w(){lt({targetEl:f.value,offset:e.offset,anchorEl:g.value,anchorOrigin:X.value,selfOrigin:ie.value,absoluteOffset:u,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function I(){return p(de,W.value,()=>y.value===!0?p("div",{role:"menu",...i,ref:f,tabindex:-1,class:["q-menu q-position-engine scroll"+q.value,i.class],style:[i.style,$.value],...O.value},Ee(t.default)):null)}return me(Y),Object.assign(d,{focus:P,updatePosition:w}),ne}});let G=0;const wt={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},pe={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var Tt=ve({name:"QDialog",inheritAttrs:!1,props:{...Be,...Fe,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:e=>e==="standard"||["top","bottom","left","right"].includes(e)}},emits:[...Le,"shake","click","escapeKey"],setup(e,{slots:t,emit:a,attrs:i}){const s=Ce(),u=z(null),l=z(!1),h=z(!1);let v=null,d=null,c,f;const y=m(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:A}=vt(),{registerTimeout:R}=Oe(),{registerTick:Z,removeTick:K}=He(),{transitionProps:V,transitionStyle:W}=_e(e,()=>pe[e.position][0],()=>pe[e.position][1]),{showPortal:$,hidePortal:L,portalIsAccessible:ee,renderPortal:te}=Me(s,u,se,"dialog"),{hide:g}=De({showing:l,hideOnRouteChange:y,handleShow:X,handleHide:ie,processOnMount:!0}),{addToHistory:oe,removeFromHistory:Q}=ct(l,g,y),j=m(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${wt[e.position]}`+(h.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),x=m(()=>l.value===!0&&e.seamless!==!0),ne=m(()=>e.autoClose===!0?{onClick:le}:{}),H=m(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${x.value===!0?"modal":"seamless"}`,i.class]);J(()=>e.maximized,n=>{l.value===!0&&_(n)}),J(x,n=>{A(n),n===!0?(Ve(B),Re(C)):(fe(B),N(C))});function X(n){oe(),d=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,_(e.maximized),$(),h.value=!0,e.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),Z(q)):K(),R(()=>{if(s.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:r,bottom:w}=document.activeElement.getBoundingClientRect(),{innerHeight:I}=window,o=window.visualViewport!==void 0?window.visualViewport.height:I;r>0&&w>o/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-o,w>=I?1/0:Math.ceil(document.scrollingElement.scrollTop+w-o/2))),document.activeElement.scrollIntoView()}f=!0,u.value.click(),f=!1}$(!0),h.value=!1,a("show",n)},e.transitionDuration)}function ie(n){K(),Q(),P(!0),h.value=!0,L(),d!==null&&(((n&&n.type.indexOf("key")===0?d.closest('[tabindex]:not([tabindex^="-"])'):void 0)||d).focus(),d=null),R(()=>{L(!0),h.value=!1,a("hide",n)},e.transitionDuration)}function q(n){ze(()=>{let r=u.value;r===null||r.contains(document.activeElement)===!0||(r=(n!==""?r.querySelector(n):null)||r.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.querySelector("[autofocus], [data-autofocus]")||r,r.focus({preventScroll:!0}))})}function O(n){n&&typeof n.focus=="function"?n.focus({preventScroll:!0}):q(),a("shake");const r=u.value;r!==null&&(r.classList.remove("q-animate--scale"),r.classList.add("q-animate--scale"),v!==null&&clearTimeout(v),v=setTimeout(()=>{v=null,u.value!==null&&(r.classList.remove("q-animate--scale"),q())},170))}function C(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&O():(a("escapeKey"),g()))}function P(n){v!==null&&(clearTimeout(v),v=null),(n===!0||l.value===!0)&&(_(!1),e.seamless!==!0&&(A(!1),fe(B),N(C))),n!==!0&&(d=null)}function _(n){n===!0?c!==!0&&(G<1&&document.body.classList.add("q-body--dialog"),G++,c=!0):c===!0&&(G<2&&document.body.classList.remove("q-body--dialog"),G--,c=!1)}function le(n){f!==!0&&(g(n),a("click",n))}function Y(n){e.persistent!==!0&&e.noBackdropDismiss!==!0?g(n):e.noShake!==!0&&O()}function B(n){e.allowFocusOutside!==!0&&ee.value===!0&&Pe(u.value,n.target)!==!0&&q('[tabindex]:not([tabindex="-1"])')}Object.assign(s.proxy,{focus:q,shake:O,__updateRefocusTarget(n){d=n||null}}),me(P);function se(){return p("div",{role:"dialog","aria-modal":x.value===!0?"true":"false",...i,class:H.value},[p(de,{name:"q-transition--fade",appear:!0},()=>x.value===!0?p("div",{class:"q-dialog__backdrop fixed-full",style:W.value,"aria-hidden":"true",tabindex:-1,onClick:Y}):null),p(de,V.value,()=>l.value===!0?p("div",{ref:u,class:j.value,style:W.value,tabindex:-1,...ne.value},Ee(t.default)):null)])}return te}});export{pt as Q,vt as a,St as b,Tt as c,ct as u};
